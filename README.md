# 麻将计分小程序

## 项目简介

这是一个基于微信小程序原生框架开发的麻将计分工具，支持单人计分和多人计分（最多4人），提供实时分数同步、好友邀请、历史记录等功能，帮助用户更方便地进行麻将游戏的计分管理。

## 核心功能

### 1. 房间管理
- 创建多人房间（2-4人）
- 生成唯一房间ID
- 邀请微信好友加入房间

### 2. 计分功能
- 支持赢分/输分操作
- 自动平衡分数（确保总分为0）
- 实时显示所有玩家分数
- 记录详细的计分历史

### 3. 实时同步
- 基于微信云开发实现实时数据同步
- 所有房间成员实时查看分数变化
- 房主结算后，其他成员同步查看结果

### 4. 结算功能
- 只有房主可以结算对局
- 结算前弹出确认提示，防止误触
- 显示最终得分情况
- 保存结算记录到历史

### 5. 历史记录
- 保存所有计分记录
- 查看历史对局详情
- 分析历史得分情况

## 技术实现

### 开发框架
- 微信小程序原生框架（wxml + wxss + js + json）

### 数据存储
- 本地存储：`wx.setStorageSync` 和 `wx.getStorageSync`
- 云数据库：微信云开发数据库

### 实时同步
- 云数据库 `watch` 方法实现实时数据监听

### 用户交互
- 模态弹窗：`wx.showModal`
- 提示信息：`wx.showToast`
- 分享功能：`wx.updateShareMenu` 和 `onShareAppMessage`

## 项目结构

```
majianjifen/
├── assets/              # 静态资源
│   ├── icon-history-active.png
│   ├── icon-history.png
│   ├── icon-home-active.png
│   └── icon-home.png
├── pages/               # 页面文件
│   ├── create-room/     # 创建房间页面
│   ├── history/         # 历史记录页面
│   ├── index/           # 首页
│   ├── result/          # 结算结果页面
│   └── room/            # 房间页面（核心）
├── app.js               # 小程序入口文件
├── app.json             # 小程序配置文件
├── app.wxss             # 小程序全局样式
├── .gitignore           # Git 忽略文件
└── README.md            # 项目说明文档
```

## 使用方法

### 1. 创建房间
- 进入首页，点击「创建房间」
- 设置房间名称、玩家数量和初始分数
- 点击「创建」按钮生成房间

### 2. 邀请好友
- 进入房间后，点击「邀请」按钮
- 选择微信好友发送分享卡片
- 好友点击卡片进入房间

### 3. 计分操作
- 点击选择要计分的玩家
- 输入分数或选择快速得分
- 点击「赢」或「输」按钮进行计分
- 系统自动平衡其他玩家的分数

### 4. 结算对局
- 房主点击「结算」按钮
- 确认结算后，系统保存对局记录
- 所有房间成员可查看结算结果

## 注意事项

1. 请确保微信开发者工具已开启云开发功能
2. 首次使用需授权获取微信用户信息
3. 多人模式需要网络连接以实现实时同步
4. 请妥善保管房间ID，避免泄露给无关人员

## 版本更新

### v1.0.1
- 优化分数平衡检查，添加错误提示
- 改进用户信息获取，使用 wx.getUserProfile
- 优化房间ID生成，使用时间戳+随机数确保唯一性
- 完善分享卡片功能，添加分享图片
- 启用快速得分按钮功能
- 添加同步状态提示，提升用户体验

### v1.0.0
- 实现核心计分功能
- 支持多人房间创建
- 实现实时分数同步
- 添加好友邀请功能
- 保存历史记录

## 未来计划

- [ ] 添加更多游戏模式
- [ ] 优化分享卡片设计
- [ ] 实现数据统计分析
- [ ] 支持自定义规则
- [ ] 增加音效和动画效果

## 反馈与建议

如有任何问题或建议，欢迎联系开发者。

---

**© 2024 麻将计分小程序**